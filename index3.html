<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Job Schedule Table</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        .side-menu {
            width: 200px;
            background: #f8f9fa;
            border-right: 1px solid #dee2e6;
            padding: 10px 0;
            flex-shrink: 0;
            overflow-y: auto;
            height: 100%;
        }

        .menu-item {
            padding: 8px 20px;
            display: flex;
            align-items: center;
            color: #1a237e;
            text-decoration: none;
            font-size: 13px;
        }

        .menu-item:hover {
            background: #e9ecef;
        }

        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .main-content {
            flex: 1;
            overflow-x: auto;
            min-width: 0;
            padding: 10px;
            height: 100%;
            overflow-y: auto;
        }

        .schedule-container {
            display: flex;
            min-width: fit-content;
            margin-bottom: 20px;
        }

        .column {
            flex: 1;
            border: 1px solid #ccc;
            min-width: 150px;
            max-width: 300px;
            background: #f4f4f4;
            padding: 5px;
            transition: background 0.3s;
            position: relative;
            overflow-y: hidden;
        }

        .column-header {
            background: #2c3e50;
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 5px;
            background: #555;
        }

        .progress-bar-fill {
            height: 100%;
            background: #4caf50;
        }

        .job {
            background: #dce6f1;
            padding: 3px 4px;
            border-radius: 5px;
            font-size: 11px;
            cursor: grab;
            word-break: break-word;
            overflow: hidden;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            gap: 1px;
            margin-bottom: 3px;
        }

        .job-id,
        .job-time,
        .job-duration {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
            min-height: 1.2em;
            flex-shrink: 0;
        }

        .job-customer {
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
            min-height: 1.2em;
            white-space: normal;
            margin-bottom: 2px;
            word-break: break-word;
            flex-shrink: 0;
        }

        .job-description {
            font-style: italic;
            color: #555;
            line-height: 1.2;
            word-break: break-word;
            overflow: hidden;
            flex: 1;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: unset;
        }

        /* Only clamp description when it would overflow */
        .job.overflow .job-description {
            -webkit-line-clamp: 3;
        }

        /* Only apply line clamping when the card is too small */
        @media screen and (max-height: 100px) {
            .job-description {
                display: -webkit-box;
                -webkit-line-clamp: 1;
                -webkit-box-orient: vertical;
            }
        }

        /* Standard layout (larger screens) */
        @media screen and (min-width: 1821px) {
            .job {
                padding: 2px 4px;
            }

            .column {
                min-width: 140px;
                max-width: 280px;
            }
        }

        /* Compact layout (smaller screens) */
        @media screen and (max-width: 1820px) {
            .column {
                min-width: 120px;
                max-width: 260px;
                padding: 3px;
            }

            .job {
                font-size: 10px;
                padding: 2px 3px;
                min-height: 2.4em;
            }

            .job-customer {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
            }

            .job.overflow .job-description {
                -webkit-line-clamp: 2;
            }
        }

        /* Add additional breakpoint for very narrow screens */
        @media screen and (max-width: 1520px) {
            .column {
                min-width: 110px;
                padding: 2px;
            }

            .column-header {
                padding: 6px 4px;
                font-size: 11px;
            }

            .job {
                font-size: 9px;
            }

            .progress-bar {
                height: 3px;
            }
        }

        /* Media query for wide screens */
        @media screen and (min-width: 2760px) {
            .column {
                max-width: 400px;
            }
        }

        /* Media query for ultra-wide screens */
        @media screen and (min-width: 3400px) {
            .column {
                max-width: 450px;
            }
        }

        .column.drag-over {
            background: #e8e8e8;
        }

        .tooltip {
            display: none;
            position: absolute;
            background: #f0f0f0;
            border: 1px solid #ccc;
            padding: 10px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.2);
            width: 300px;
            border-radius: 5px;
        }

        .tooltip .tooltip-header {
            background: #d3d3d3;
            font-weight: bold;
            padding: 8px;
            margin: -10px -10px 10px -10px;
            border-bottom: 1px solid #ccc;
        }

        /* Add this to your CSS */
        .controls {
            margin-bottom: 10px;
            font-size: 13px;
        }

        .controls label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .controls input[type="checkbox"] {
            cursor: pointer;
        }

        /* Update jobsContainer styles */
        .jobs-container {
            padding: 5px;
            display: flex;
            flex-direction: column;
            gap: 3px;
        }
    </style>
</head>

<body>
    <div class="side-menu">
        <a href="#" class="menu-item">
            <i>üè†</i>Home
        </a>
        <a href="#" class="menu-item">
            <i>‚öôÔ∏è</i>Settings
        </a>
        <a href="#" class="menu-item">
            <i>üìä</i>Leads
        </a>
        <a href="#" class="menu-item">
            <i>üì¶</i>Inventory
        </a>
        <a href="#" class="menu-item">
            <i>üìà</i>Reports
        </a>
        <a href="#" class="menu-item">
            <i>üìã</i>Jobs
        </a>
        <a href="#" class="menu-item">
            <i>üì±</i>Mobile View
        </a>
        <a href="#" class="menu-item">
            <i>üé´</i>Tickets
        </a>
        <a href="#" class="menu-item">
            <i>üìû</i>CallTrak
        </a>
        <a href="#" class="menu-item">
            <i>üìä</i>Sales Dashboard
        </a>
        <a href="#" class="menu-item">
            <i>üë•</i>Customers
        </a>
        <a href="#" class="menu-item">
            <i>üîÑ</i>Workflow
        </a>
        <a href="#" class="menu-item">
            <i>üìã</i>Projects
        </a>
        <a href="#" class="menu-item">
            <i>üì•</i>Incoming Documents
        </a>
        <a href="#" class="menu-item">
            <i>üí∞</i>Price Check
        </a>
        <a href="#" class="menu-item">
            <i>üìÑ</i>Documents
        </a>
        <a href="#" class="menu-item">
            <i>üìÖ</i>Calendar
        </a>
        <a href="#" class="menu-item">
            <i>üîß</i>Utilities
        </a>
        <a href="#" class="menu-item">
            <i>üìÖ</i>Schedule
        </a>
        <a href="#" class="menu-item">
            <i>üìù</i>To-Do
        </a>
        <a href="#" class="menu-item">
            <i>üé´</i>Tickets Dashboard
        </a>
        <a href="#" class="menu-item">
            <i>‚è±Ô∏è</i>Timesheets
        </a>
        <a href="#" class="menu-item">
            <i>üñ•Ô∏è</i>Conference Mode
        </a>
        <hr style="margin: 10px 0; border-top: 1px solid #dee2e6;">
        <a href="#" class="menu-item">
            <i>‚ùì</i>Support Centre
        </a>
        <a href="#" class="menu-item">
            <i>‚ùî</i>Help With This Page
        </a>
    </div>
    <div class="main-content">
        <div class="controls">
            <label>
                <input type="checkbox" id="showDetail" checked>
                Show more detail for each job
            </label>
        </div>
        <div class="schedule-container" id="schedule"></div>
        <div id="tooltip" class="tooltip"></div>
    </div>

    <script>
        const fullTechList = [
            "Alice",
            "Bob",
            "Charlie",
            "Diana",
            "Ethan",
            "Fiona",
            "George",
            "Hannah",
            "Isaac",
            "Unallocated",
        ];

        const shortTechList = [
            "Alice",
            "Bob",
            "Charlie",
            "Diana",
            "Unallocated",
        ];

        let technicians = fullTechList;
        let showJobDetail = true;

        // Add keyboard event listener
        document.addEventListener('keydown', function (event) {
            if (event.key.toLowerCase() === 't') {
                technicians = technicians.length > 5 ? shortTechList : fullTechList;
                generateSchedule();
            }
        });

        // Add event listener for checkbox
        document.getElementById('showDetail').addEventListener('change', function (e) {
            showJobDetail = e.target.checked;
            generateSchedule();
        });

        const jobs = {
            Alice: [
                {
                    id: "JB1401",
                    start: "07:00",
                    duration: 2,
                    customer: "Australian Communications & Network Solutions Pty Ltd",
                    added: "01/02/2025 11:04",
                    address: "Sydney",
                    description: "Install a VoIP system, ensuring seamless integration with the existing network. Configure SIP trunks, set up extension groups, and test call routing functionality. Provide training for end-users on system operation and basic troubleshooting procedures.",
                },
                {
                    id: "JB1402",
                    start: "09:00",
                    duration: 3,
                    customer: "Metropolitan Infrastructure Services Group",
                    added: "02/02/2025 14:20",
                    address: "Melbourne",
                    description: "Repair network switch by diagnosing port failures and replacing damaged components. Verify VLAN configurations and ensure redundancy for critical systems. Conduct post-repair tests to confirm network stability before closing the job.",
                },
                {
                    id: "JB1415",
                    start: "13:00",
                    duration: 2,
                    customer: "Integrated Business Technologies International",
                    added: "11/02/2025 13:20",
                    address: "Brisbane",
                    description: "Perform a comprehensive network security audit, identifying potential vulnerabilities. Conduct penetration testing, assess firewall configurations, and verify access control policies. Provide recommendations to enhance security and protect sensitive data from external threats.",
                },
            ],
            Bob: [
                {
                    id: "JB1403",
                    start: "11:00",
                    duration: 1,
                    customer: "Queensland Healthcare Information Systems Ltd",
                    added: "03/02/2025 09:15",
                    address: "Brisbane",
                    description: "Replace a damaged fibre-optic cable to restore high-speed connectivity. Conduct signal testing before and after replacement to ensure optimal performance. Coordinate with IT staff to minimize downtime for critical healthcare applications.",
                },
            ],
            Charlie: [
                {
                    id: "JB1405",
                    start: "10:00",
                    duration: 2,
                    customer: "Southern Cross Digital Infrastructure Solutions",
                    added: "05/02/2025 10:30",
                    address: "Adelaide",
                    description: "Upgrade PBX system to support advanced call management features, including IVR and voicemail-to-email. Migrate existing configurations, test call routing rules, and ensure system stability post-upgrade.",
                },
                {
                    id: "JB1406",
                    start: "13:00",
                    duration: 2,
                    customer: "Enterprise Data Management Associates Pty Ltd",
                    added: "06/02/2025 15:30",
                    address: "Melbourne",
                    description: "Conduct server maintenance, including system updates, disk cleanups, and hardware diagnostics. Optimize server performance by fine-tuning resource allocations and removing obsolete services.",
                },
                {
                    id: "JB1416",
                    start: "15:30",
                    duration: 2,
                    customer: "Sigma Corp",
                    added: "12/02/2025 09:15",
                    address: "Perth",
                    description: "Optimize database performance by analyzing query execution times and indexing frequently accessed tables. Identify and resolve slow-running transactions, ensuring efficient data retrieval for business operations.",
                },
                {
                    id: "JB1417",
                    start: "08:00",
                    duration: 1,
                    customer: "Phi Solutions",
                    added: "13/02/2025 11:45",
                    address: "Sydney",
                    description: "Perform hardware diagnostics on critical network infrastructure, testing power supplies, cooling systems, and component integrity. Report any issues and recommend replacements if necessary.",
                },
            ],
            Diana: [
                {
                    id: "JB1407",
                    start: "14:30",
                    duration: 3,
                    customer: "Eta Corp",
                    added: "07/02/2025 12:00",
                    address: "Sydney",
                    description: "Recover lost data from a failed backup system by restoring files from secondary storage. Validate data integrity, reconfigure automated backup schedules, and implement redundancy measures to prevent future data loss.",
                },
                {
                    id: "JB1408",
                    start: "16:00",
                    duration: 1,
                    customer: "Theta Solutions",
                    added: "08/02/2025 09:50",
                    address: "Brisbane",
                    description: "Configure and deploy a new firewall system to enhance network security. Set up access control rules, monitor traffic patterns, and test intrusion prevention mechanisms.",
                },
            ],
            Ethan: [
                {
                    id: "JB1409",
                    start: "17:00",
                    duration: 2,
                    customer: "Iota Services",
                    added: "09/02/2025 14:10",
                    address: "Perth",
                    description: "Conduct a comprehensive system security audit, reviewing access logs, password policies, and network encryption. Provide recommendations to strengthen security against emerging cyber threats.",
                },
                {
                    id: "JB1410",
                    start: "08:30",
                    duration: 2,
                    customer: "Lambda Tech",
                    added: "10/02/2025 08:45",
                    address: "Melbourne",
                    description: "Set up a cloud backup solution for mission-critical data, ensuring seamless replication and recovery options. Configure encryption settings and test backup integrity.",
                },
                {
                    id: "JB1418",
                    start: "11:00",
                    duration: 3,
                    customer: "Rho Technologies",
                    added: "14/02/2025 10:30",
                    address: "Adelaide",
                    description: "Perform maintenance on the server room, including cooling system checks, cable management improvements, and rack stability testing. Ensure optimal environmental conditions for hardware longevity.",
                },
            ],
            Fiona: [
                {
                    id: "JB1411",
                    start: "09:30",
                    duration: 4,
                    customer: "Kappa Industries",
                    added: "15/02/2025 08:20",
                    address: "Sydney",
                    description: "Upgrade the entire network infrastructure, replacing legacy switches with high-performance models. Implement VLAN segmentation, ensure redundancy, and optimize bandwidth allocation for better performance.",
                },
                {
                    id: "JB1412",
                    start: "14:00",
                    duration: 2,
                    customer: "Nu Solutions",
                    added: "16/02/2025 13:40",
                    address: "Melbourne",
                    description: "Optimize wireless network coverage by adjusting access point placement, reducing interference, and fine-tuning signal strength to eliminate dead zones.",
                },
            ],
            George: [
                {
                    id: "JB1413",
                    start: "08:00",
                    duration: 5,
                    customer: "Xi Corp",
                    added: "17/02/2025 09:10",
                    address: "Brisbane",
                    description: "Execute a full-scale data center migration, ensuring minimal downtime and seamless transition. Migrate virtual machines, update IP configurations, and verify storage integration.",
                },
            ],
            Hannah: [
                {
                    id: "JB1414",
                    start: "10:00",
                    duration: 3,
                    customer: "Mu Systems",
                    added: "18/02/2025 11:25",
                    address: "Perth",
                    description: "Install a new security system, including CCTV cameras, biometric access control, and intrusion detection sensors. Test each component for proper functionality.",
                },
                {
                    id: "JB1419",
                    start: "14:00",
                    duration: 2,
                    customer: "Pi Technologies",
                    added: "19/02/2025 15:30",
                    address: "Adelaide",
                    description: "Deploy and configure enterprise software, including user role assignments, security settings, and performance optimizations. Provide training on system usage.",
                },
                {
                    id: "JB1420",
                    start: "16:30",
                    duration: 1,
                    customer: "Chi Solutions",
                    added: "20/02/2025 12:15",
                    address: "Sydney",
                    description: "Perform scheduled hardware maintenance, cleaning components, updating firmware, and testing system stability for critical infrastructure devices.",
                },
            ],
            Isaac: [
                {
                    id: "JB1421",
                    start: "09:00",
                    duration: 3,
                    customer: "Upsilon Corp",
                    added: "21/02/2025 08:45",
                    address: "Melbourne",
                    description: "Troubleshoot network issues affecting multiple departments, performing diagnostics on switches, routers, and firewall configurations. Implement corrective actions and document findings.",
                },
                {
                    id: "JB1422",
                    start: "13:00",
                    duration: 2,
                    customer: "Tau Industries",
                    added: "22/02/2025 10:20",
                    address: "Brisbane",
                    description: "Upgrade system hardware and software to enhance processing speed and reliability. Replace outdated components, install patches, and verify stability post-upgrade.",
                },
            ],
        };

        function generateSchedule() {
            const schedule = document.getElementById("schedule");
            schedule.innerHTML = "";

            // Fixed measurements
            const WORK_DAY_HOURS = 8;
            const HOUR_HEIGHT = 70;
            const HEADER_HEIGHT = 45;
            const CONTENT_PADDING = 5;

            // Total height calculation
            const WORK_AREA_HEIGHT = WORK_DAY_HOURS * HOUR_HEIGHT;  // 8 hours * 70px = 560px
            const TOTAL_HEIGHT = WORK_AREA_HEIGHT + HEADER_HEIGHT + (CONTENT_PADDING * 2);

            technicians.forEach((tech) => {
                const column = document.createElement("div");
                column.classList.add("column");
                column.setAttribute("ondrop", "drop(event)");
                column.setAttribute("ondragover", "allowDrop(event)");
                column.setAttribute("ondragenter", "highlightDropZone(event)");
                column.setAttribute("ondragleave", "unhighlightDropZone(event)");
                column.dataset.technician = tech;

                // Calculate total hours for technician
                const totalHours = jobs[tech]?.reduce((sum, job) => sum + job.duration, 0) || 0;
                const progressPercentage = (totalHours / WORK_DAY_HOURS) * 100;

                if (tech === "Unallocated") {
                    column.innerHTML = `
                        <div class='column-header'>
                            ${tech}
                        </div>
                    `;
                } else {
                    column.innerHTML = `
                        <div class='column-header'>
                            ${tech}
                            <div class='progress-bar'>
                                <div class='progress-bar-fill' style='width: ${progressPercentage}%;'></div>
                            </div>
                        </div>
                    `;
                }

                column.style.height = `${TOTAL_HEIGHT}px`;

                if (jobs[tech]) {
                    const jobsContainer = document.createElement("div");
                    jobsContainer.classList.add('jobs-container');
                    jobsContainer.style.padding = `${CONTENT_PADDING}px`;
                    jobsContainer.style.height = `${WORK_AREA_HEIGHT}px`;
                    jobsContainer.style.display = 'flex';
                    jobsContainer.style.flexDirection = 'column';
                    jobsContainer.style.gap = '3px';

                    jobs[tech].forEach((job) =>
                        jobsContainer.appendChild(createJobElement(job, HOUR_HEIGHT))
                    );
                    column.appendChild(jobsContainer);
                }

                schedule.appendChild(column);
            });
        }

        function createJobElement(job, hourHeight) {
            const jobElement = document.createElement("div");
            jobElement.classList.add("job");
            jobElement.setAttribute("draggable", "true");
            jobElement.setAttribute("ondragstart", "drag(event)");
            jobElement.setAttribute("id", job.id);

            // Calculate base height from duration
            const baseHeight = job.duration * hourHeight;

            // Add padding for content
            const extraPadding = showJobDetail ? 15 : 10;
            jobElement.style.height = `${baseHeight + extraPadding}px`;

            // Modify the innerHTML based on showJobDetail
            jobElement.innerHTML = `
                <div class="job-id">${job.id}</div>
                <div class="job-time">@${job.start}</div>
                <div class="job-duration">(${job.duration}h)</div>
                ${showJobDetail ? `
                    <div class="job-customer">${job.customer}</div>
                    <div class="job-description">${job.description}</div>
                ` : ''}
            `;

            // Check if description overflows and add class if it does
            if (showJobDetail) {
                setTimeout(() => {
                    const descriptionEl = jobElement.querySelector('.job-description');
                    if (descriptionEl.scrollHeight > descriptionEl.clientHeight) {
                        jobElement.classList.add('overflow');
                    }
                }, 0);
            }

            jobElement.addEventListener("mouseover", (e) => showTooltip(e, job));
            jobElement.addEventListener("mouseout", hideTooltip);
            return jobElement;
        }

        function showTooltip(event, job) {
            const tooltip = document.getElementById("tooltip");
            tooltip.innerHTML = `<div class="tooltip-header">Customer: ${job.customer}</div><strong>Time Added:</strong> ${job.added}<br><strong>Job Address:</strong> ${job.address}<br><strong>Job Type:</strong> Service Request<br><strong>Job Status:</strong> Booked<br><strong>Job Description:</strong> ${job.description}`;
            tooltip.style.display = "block";
            tooltip.style.left = `${event.pageX + 10}px`;
            tooltip.style.top = `${event.pageY + 10}px`;
        }

        function hideTooltip() {
            document.getElementById("tooltip").style.display = "none";
        }

        function drag(event) {
            hideTooltip();
            event.dataTransfer.setData("text", event.target.id);
        }

        function allowDrop(event) {
            event.preventDefault();
        }

        function drop(event) {
            event.preventDefault();
            const jobId = event.dataTransfer.getData("text");
            const jobElement = document.getElementById(jobId);
            const newColumn = event.target.closest(".column");
            if (!newColumn) return;

            // Remove drag-over class
            newColumn.classList.remove("drag-over");

            // Find or create jobsContainer in the new column
            let jobsContainer = newColumn.querySelector('.jobs-container');
            if (!jobsContainer) {
                jobsContainer = document.createElement("div");
                jobsContainer.classList.add('jobs-container');
                jobsContainer.style.padding = `5px`;
                jobsContainer.style.height = `560px`;
                jobsContainer.style.display = 'flex';
                jobsContainer.style.flexDirection = 'column';
                jobsContainer.style.gap = '3px';
                newColumn.appendChild(jobsContainer);
            }

            // Add the job to the container
            jobsContainer.appendChild(jobElement);
        }

        function highlightDropZone(event) {
            event.preventDefault();
            const column = event.target.closest(".column");
            if (column) {
                column.classList.add("drag-over");
            }
        }

        function unhighlightDropZone(event) {
            const column = event.target.closest(".column");
            if (column) {
                column.classList.remove("drag-over");
            }
        }

        generateSchedule();
    </script>
</body>

</html>