<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Job Schedule Table</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            overflow-x: auto;
        }

        .schedule-container {
            display: flex;
            width: 100vw;
        }

        .column {
            flex: 1;
            border: 1px solid #ccc;
            min-width: 150px;
            max-width: 350px;
            background: #f4f4f4;
            padding: 5px;
            min-height: 150px;
            transition: background 0.3s;
        }

        .column-header {
            background: #2c3e50;
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 5px;
            background: #555;
        }

        .progress-bar-fill {
            height: 100%;
            background: #4caf50;
        }

        .job {
            background: #dce6f1;
            margin: 5px;
            padding: 10px;
            border-radius: 5px;
            font-size: 11px;
            cursor: grab;
            min-height: 30px;
            word-break: break-word;
            overflow: hidden;
        }

        .job-id {
            font-weight: bold;
            display: inline;
        }

        .job-time,
        .job-duration,
        .job-customer {
            display: inline;
        }

        /* Media query for narrow screens */
        @media screen and (max-width: 1620px) {
            .column {
                min-width: 120px;
                padding: 3px;
            }

            .job {
                font-size: 10px;
                padding: 8px;
                margin: 3px;
            }

            .job-id,
            .job-time,
            .job-duration,
            .job-customer {
                display: block;
                margin-bottom: 3px;
                line-height: 1.2;
            }
        }

        /* Add additional breakpoint for very narrow screens */
        @media screen and (max-width: 1320px) {
            .column {
                min-width: 110px;
                padding: 2px;
            }

            .column-header {
                padding: 6px 4px;
                font-size: 11px;
            }

            .job {
                padding: 6px;
                margin: 2px;
                font-size: 9px;
            }

            .job-id,
            .job-time,
            .job-duration,
            .job-customer {
                margin-bottom: 2px;
                line-height: 1.1;
            }

            .progress-bar {
                height: 3px;
            }
        }

        /* Media query for wide screens */
        @media screen and (min-width: 2560px) {
            .column {
                max-width: 400px;
            }
        }

        /* Media query for ultra-wide screens */
        @media screen and (min-width: 3200px) {
            .column {
                max-width: 450px;
            }
        }

        .column.drag-over {
            background: #ddd !important;
        }

        .tooltip {
            display: none;
            position: absolute;
            background: #f0f0f0;
            border: 1px solid #ccc;
            padding: 10px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.2);
            width: 300px;
            border-radius: 5px;
        }

        .tooltip .tooltip-header {
            background: #d3d3d3;
            font-weight: bold;
            padding: 8px;
            margin: -10px -10px 10px -10px;
            border-bottom: 1px solid #ccc;
        }
    </style>
</head>

<body>
    <div class="schedule-container" id="schedule"></div>
    <div id="tooltip" class="tooltip"></div>

    <script>
        const fullTechList = [
            "Alice",
            "Bob",
            "Charlie",
            "Diana",
            "Ethan",
            "Fiona",
            "George",
            "Hannah",
            "Isaac",
            "Unallocated",
        ];

        const shortTechList = [
            "Alice",
            "Bob",
            "Charlie",
            "Diana",
            "Unallocated",
        ];

        let technicians = fullTechList;

        // Add keyboard event listener
        document.addEventListener('keydown', function (event) {
            if (event.key.toLowerCase() === 't') {
                technicians = technicians.length > 5 ? shortTechList : fullTechList;
                generateSchedule();
            }
        });

        const jobs = {
            Alice: [
                {
                    id: "JB1401",
                    start: "07:00",
                    duration: 2,
                    customer: "Acme Corp",
                    added: "01/02/2025 11:04",
                    address: "Sydney",
                    description: "Install VoIP system.",
                },
                {
                    id: "JB1402",
                    start: "09:00",
                    duration: 3,
                    customer: "Beta Ltd",
                    added: "02/02/2025 14:20",
                    address: "Melbourne",
                    description: "Repair network switch.",
                },
                {
                    id: "JB1415",
                    start: "13:00",
                    duration: 2,
                    customer: "Omega Systems",
                    added: "11/02/2025 13:20",
                    address: "Brisbane",
                    description: "Network security audit.",
                },
            ],
            Bob: [
                {
                    id: "JB1403",
                    start: "11:00",
                    duration: 1,
                    customer: "Gamma Industries",
                    added: "03/02/2025 09:15",
                    address: "Brisbane",
                    description: "Replace fibre-optic cable.",
                },
            ],
            Charlie: [
                {
                    id: "JB1405",
                    start: "10:00",
                    duration: 2,
                    customer: "Epsilon Co.",
                    added: "05/02/2025 10:30",
                    address: "Adelaide",
                    description: "Upgrade PBX system.",
                },
                {
                    id: "JB1406",
                    start: "13:00",
                    duration: 2,
                    customer: "Zeta Ltd",
                    added: "06/02/2025 15:30",
                    address: "Melbourne",
                    description: "Server maintenance.",
                },
                {
                    id: "JB1416",
                    start: "15:30",
                    duration: 2,
                    customer: "Sigma Corp",
                    added: "12/02/2025 09:15",
                    address: "Perth",
                    description: "Database optimization.",
                },
                {
                    id: "JB1417",
                    start: "08:00",
                    duration: 1,
                    customer: "Phi Solutions",
                    added: "13/02/2025 11:45",
                    address: "Sydney",
                    description: "Hardware diagnostics.",
                },
            ],
            Diana: [
                {
                    id: "JB1407",
                    start: "14:30",
                    duration: 3,
                    customer: "Eta Corp",
                    added: "07/02/2025 12:00",
                    address: "Sydney",
                    description: "Data backup recovery.",
                },
                {
                    id: "JB1408",
                    start: "16:00",
                    duration: 1,
                    customer: "Theta Solutions",
                    added: "08/02/2025 09:50",
                    address: "Brisbane",
                    description: "Firewall configuration.",
                },
            ],
            Ethan: [
                {
                    id: "JB1409",
                    start: "17:00",
                    duration: 2,
                    customer: "Iota Services",
                    added: "09/02/2025 14:10",
                    address: "Perth",
                    description: "System security audit.",
                },
                {
                    id: "JB1410",
                    start: "08:30",
                    duration: 2,
                    customer: "Lambda Tech",
                    added: "10/02/2025 08:45",
                    address: "Melbourne",
                    description: "Cloud backup setup.",
                },
                {
                    id: "JB1418",
                    start: "11:00",
                    duration: 3,
                    customer: "Rho Technologies",
                    added: "14/02/2025 10:30",
                    address: "Adelaide",
                    description: "Server room maintenance.",
                },
            ],
            Fiona: [
                {
                    id: "JB1411",
                    start: "09:30",
                    duration: 4,
                    customer: "Kappa Industries",
                    added: "15/02/2025 08:20",
                    address: "Sydney",
                    description: "Network infrastructure upgrade.",
                },
                {
                    id: "JB1412",
                    start: "14:00",
                    duration: 2,
                    customer: "Nu Solutions",
                    added: "16/02/2025 13:40",
                    address: "Melbourne",
                    description: "Wireless network optimization.",
                },
            ],
            George: [
                {
                    id: "JB1413",
                    start: "08:00",
                    duration: 5,
                    customer: "Xi Corp",
                    added: "17/02/2025 09:10",
                    address: "Brisbane",
                    description: "Data center migration.",
                },
            ],
            Hannah: [
                {
                    id: "JB1414",
                    start: "10:00",
                    duration: 3,
                    customer: "Mu Systems",
                    added: "18/02/2025 11:25",
                    address: "Perth",
                    description: "Security system installation.",
                },
                {
                    id: "JB1419",
                    start: "14:00",
                    duration: 2,
                    customer: "Pi Technologies",
                    added: "19/02/2025 15:30",
                    address: "Adelaide",
                    description: "Software deployment.",
                },
                {
                    id: "JB1420",
                    start: "16:30",
                    duration: 1,
                    customer: "Chi Solutions",
                    added: "20/02/2025 12:15",
                    address: "Sydney",
                    description: "Hardware maintenance.",
                },
            ],
            Isaac: [
                {
                    id: "JB1421",
                    start: "09:00",
                    duration: 3,
                    customer: "Upsilon Corp",
                    added: "21/02/2025 08:45",
                    address: "Melbourne",
                    description: "Network troubleshooting.",
                },
                {
                    id: "JB1422",
                    start: "13:00",
                    duration: 2,
                    customer: "Tau Industries",
                    added: "22/02/2025 10:20",
                    address: "Brisbane",
                    description: "System upgrade.",
                },
            ],
        };

        function generateSchedule() {
            const schedule = document.getElementById("schedule");
            schedule.innerHTML = "";

            technicians.forEach((tech) => {
                const column = document.createElement("div");
                column.classList.add("column");
                column.setAttribute("ondrop", "drop(event)");
                column.setAttribute("ondragover", "allowDrop(event)");
                column.setAttribute("ondragenter", "highlightDropZone(event)");
                column.setAttribute("ondragleave", "unhighlightDropZone(event)");
                column.dataset.technician = tech;

                if (tech === "Unallocated") {
                    column.innerHTML = `
              <div class='column-header'>
                ${tech}
              </div>
            `;
                } else {
                    column.innerHTML = `
              <div class='column-header'>
                ${tech}
                <div class='progress-bar'>
                  <div class='progress-bar-fill' style='width: 60%;'></div>
                </div>
              </div>
            `;
                }

                if (jobs[tech]) {
                    jobs[tech].forEach((job) =>
                        column.appendChild(createJobElement(job))
                    );
                }

                schedule.appendChild(column);
            });
        }

        function createJobElement(job) {
            const jobElement = document.createElement("div");
            jobElement.classList.add("job");
            jobElement.setAttribute("draggable", "true");
            jobElement.setAttribute("ondragstart", "drag(event)");
            jobElement.setAttribute("id", job.id);
            // Base height calculation on duration and screen width
            const baseHeight = window.innerWidth <= 1620 ?
                (35 + (job.duration * 15)) : // More height for stacked layout
                (30 * job.duration);         // Original height calculation
            jobElement.style.height = `${baseHeight}px`;
            jobElement.innerHTML = `
                <div class="job-id">${job.id}</div>
                <div class="job-time">@${job.start}</div>
                <div class="job-duration">(${job.duration}h)</div>
                <div class="job-customer">${job.customer}</div>
            `;
            jobElement.addEventListener("mouseover", (e) => showTooltip(e, job));
            jobElement.addEventListener("mouseout", hideTooltip);
            return jobElement;
        }

        function showTooltip(event, job) {
            const tooltip = document.getElementById("tooltip");
            tooltip.innerHTML = `<div class="tooltip-header">Customer: ${job.customer}</div><strong>Time Added:</strong> ${job.added}<br><strong>Job Address:</strong> ${job.address}<br><strong>Job Type:</strong> Service Request<br><strong>Job Status:</strong> Booked<br><strong>Job Description:</strong> ${job.description}`;
            tooltip.style.display = "block";
            tooltip.style.left = `${event.pageX + 10}px`;
            tooltip.style.top = `${event.pageY + 10}px`;
        }

        function hideTooltip() {
            document.getElementById("tooltip").style.display = "none";
        }

        function drag(event) {
            hideTooltip();
            event.dataTransfer.setData("text", event.target.id);
        }

        function allowDrop(event) {
            event.preventDefault();
        }

        function drop(event) {
            event.preventDefault();
            const jobId = event.dataTransfer.getData("text");
            const jobElement = document.getElementById(jobId);
            const newColumn = event.target.closest(".column");
            if (!newColumn) return;
            newColumn.appendChild(jobElement);
        }

        function highlightDropZone(event) {
            event.preventDefault();
            event.target.closest(".column")?.classList.add("drag-over");
        }

        function unhighlightDropZone(event) {
            event.target.closest(".column")?.classList.remove("drag-over");
        }

        generateSchedule();
    </script>
</body>

</html>